!function(i){function s(i){var s,t;for(s in i)t=i[s],i["-webkit-"+s]=t,i["-moz-"+s]=t,i["-ms-"+s]=t,i["-o-"+s]=t;return i}i.fn.foldscroll=function(t){var a=Math.PI,e=a/2,n=i.extend({},i.fn.foldscroll.defaults,t),r="perspective("+n.perspective+"px) rotateX(θrad)";return this.each(function(){var t,a,o=i(this),c=o.children();n.shading&&(a=i('<span class="shading"/>').css({background:n.shading,position:"absolute",opacity:0,height:"100%",width:"100%",left:0,top:0}),c.each(function(){t=i(this),t.css(s({"backface-visibility":"hidden","transform-style":"preserve-3d"})),t.data("_shading")||(a=a.clone(),t.css("position","relative"),t.data("_shading",a),t.append(a))})),o.css(s({"backface-visibility":"hidden"})),o.css({overflowY:"scroll"}),o.on("scroll",function(){var l=o.scrollTop(),f=o.offset().top-l,h=o.outerHeight(),d=f+h,p=parseFloat(n.margin);p=1>=p?Math.min(p,.5):p/h,c.each(function(o,c){t=i(this),t.css(s({transform:"none"})),a=t.find(".shading").hide();var g=t.offset().top-l,u=Math.max(p*h,t.outerHeight()),v=g+u,m=Math.max(f,g),b=Math.min(d,v),y=b>m;if(y){var M=b-m,k=M/h;if(p>k){k/=p;var w=f>g?1:-1,x=(1-k)*e*w;Math.abs(x)<=e?(t.css(s({"transform-origin":"50%"+(f>g?"100%":"0%"),transform:r.replace("θ",x)})),n.shading&&a.css("opacity",1-k).show()):y=!1}}t.css("visibility",y?"visible":"hidden")})}),o.trigger("scroll")})},i.fn.foldscroll.defaults={perspective:600,shading:"rgba(0,0,0,0.2)",margin:.2}}(jQuery),function(){"use strict";$(".gallery").foldscroll({perspective:500,margin:.5,shading:"rgba(0,0,0,0.7)"})}();